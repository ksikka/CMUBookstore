<% if(books.length == 0) { %> 
  No books match this query
<% } else { %>
  <% for(var i = 0; i < books.length; i++) { %>
    <div class="listing">
      <% var book = books[i] %>
      <% var book_id = book._id; %>

      <div>
        <span class="title"><%= book.title %></span>
        <span class="author">by <%= book.author %></span>
      </div>

        <% var courseStrings = []; %>
        <% for(var j = 0; j < books[i].course_ids.length; j++) { 
             var course = course_dictionary[books[i].course_ids[j]];
             if(course) { 
               courseStrings.push(course._id + ': ' + course.name);
             }
           } 
           if(courseStrings.length > 0) { %>
           <div>Required for <%= courseStrings.join(', ') %></div>
       <%  } %>

      <a onclick="buy(this);" href="#!buy" book_id="<%= book_id %>">Buy</a>
      |
      <a onclick="sell(this);" href="#!sell" book_id="<%= book_id %>">Sell</a>

    </div>
  <% } %>
<% } %>
